"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3031],{36797:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var r=t(85893),i=t(11151);const o={},s="askui UI Controller Docker Images",a={id:"general/Continuous Integration/askui-ui-controller-docker-images",title:"askui UI Controller Docker Images",description:"We maintain Docker Images for running tests with askui inside a Docker Container, e.g., locally or in a CI/CD pipeline. The Images are based on Ubuntu (amd64) images and contain the askui UI Controller (also known as the UiController) and a browser. Currently, we offer some of the latest versions of Chrome and Firefox. The askui library connects to the askui UI Controller inside the Docker container to execute the test steps inside it.",source:"@site/versioned_docs/version-0.7.2/general/04-Continuous Integration/askui-ui-controller-docker-images.md",sourceDirName:"general/04-Continuous Integration",slug:"/general/Continuous Integration/askui-ui-controller-docker-images",permalink:"/docs/0.7.2/general/Continuous Integration/askui-ui-controller-docker-images",draft:!1,unlisted:!1,editUrl:"https://github.com/askui/askui/tree/main/docs/versioned_docs/version-0.7.2/general/04-Continuous Integration/askui-ui-controller-docker-images.md",tags:[],version:"0.7.2",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Recommended Practices",permalink:"/docs/0.7.2/general/Guides/recommended-practices"},next:{title:"Gitlab CI/CD",permalink:"/docs/0.7.2/general/Continuous Integration/gitlab-ci"}},c={},l=[{value:"Configuration",id:"configuration",level:2},{value:"Usage",id:"usage",level:2},{value:"Starting Container <em>Manually</em>",id:"starting-container-manually",level:3},{value:"Starting Container from Within <code>beforeAll()</code> Using Testcontainers",id:"starting-container-from-within-beforeall-using-testcontainers",level:3},{value:"Connect via VNC",id:"connect-via-vnc",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"askui-ui-controller-docker-images",children:"askui UI Controller Docker Images"}),"\n",(0,r.jsxs)(n.p,{children:["We maintain Docker Images for running tests with askui inside a Docker Container, e.g., locally or in a CI/CD pipeline. The Images are based on Ubuntu (amd64) images and contain the askui UI Controller (also known as the ",(0,r.jsx)(n.em,{children:"UiController"}),") and a browser. Currently, we offer some of the latest versions of Chrome and Firefox. The askui library connects to the askui UI Controller inside the Docker container to execute the test steps inside it.\nYou can find our images on ",(0,r.jsx)(n.a,{href:"https://hub.docker.com/r/askuigmbh/askui-ui-controller",children:"DockerHub"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["\u26a0\ufe0f"," ",(0,r.jsx)(n.strong,{children:"ARM CPUs"}),": are currently not supported"]}),"\n",(0,r.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(n.p,{children:"The following environment variables can be used for configuring the Docker Container started from one of our Docker Images:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Variable"}),(0,r.jsx)(n.th,{children:"Default Value"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ENABLE_VNC"}),(0,r.jsx)(n.td,{children:"false"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"true"})," to enable VNC so that you can connect and observe whats happening inside the container. The VNC server is bound to port ",(0,r.jsx)(n.code,{children:"5900"})," of the container."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"SCREEN_RESOLUTION"}),(0,r.jsx)(n.td,{children:"1920x1080"}),(0,r.jsxs)(n.td,{children:["The screen resolution used inside the container in the format ",(0,r.jsx)(n.code,{children:"<width>x<height>"}),"."]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,r.jsxs)(n.p,{children:["The askui UI Controller is bound to port ",(0,r.jsx)(n.code,{children:"6769"})," of the container so this needs to be exposed."]}),"\n",(0,r.jsxs)(n.h3,{id:"starting-container-manually",children:["Starting Container ",(0,r.jsx)(n.em,{children:"Manually"})]}),"\n",(0,r.jsxs)(n.p,{children:["You can pull an Image using ",(0,r.jsx)(n.code,{children:"docker pull"}),", e.g.,"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"docker pull askuigmbh/askui-ui-controller:v0.10.0-firefox-82.0.3-amd64\n"})}),"\n",(0,r.jsx)(n.p,{children:"and, then, start the corresponding Container using:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"docker run -e ENABLE_VNC=true -p 6769:6769 -p 5900:5900 askuigmbh/askui-ui-controller:v0.10.0-firefox-82.0.3-amd64\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"starting-container-from-within-beforeall-using-testcontainers",children:["Starting Container from Within ",(0,r.jsx)(n.code,{children:"beforeAll()"})," Using Testcontainers"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/testcontainers/testcontainers-node",children:"Testcontainers"})," is a Node.js library that supports starting Docker Containers from within tests and throwing them away afterwards."]}),"\n",(0,r.jsx)(n.p,{children:"To use it, first install it:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"npm i -D testcontainers\n"})}),"\n",(0,r.jsxs)(n.p,{children:["After that, you can adjust the ",(0,r.jsx)(n.code,{children:"jest.setup.ts"})," that is created when running ",(0,r.jsx)(n.code,{children:"npx askui init"})," like in the following example starting the askui UI Controller container just before all tests are run and connecting to it:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { UiControlClient } from 'askui';\nimport { GenericContainer, StartedTestContainer } from 'testcontainers';\n\njest.setTimeout(60 * 1000 * 60);\n\nfunction getDockerImageName(): string {\n  const askuiUiControllerVersion = 'v0.10.0';\n  const browser = 'firefox';\n  const browserVersion = '82.0.3';\n  const osArch = 'amd64';\n  return `askuigmbh/askui-ui-controller:${askuiUiControllerVersion}-${browser}-${browserVersion}-${osArch}`;\n}\n\nasync function startTestContainer(): Promise<StartedTestContainer> {\n  const container = await new GenericContainer(getDockerImageName())\n    .withEnv('ENABLE_VNC', 'true')\n    .withEnv('SCREEN_RESOLUTION', '1920x1080')\n    .withExposedPorts(6769, 5900)\n    .start();\n\n  console.log(`VNC link: ${container.getHost()}:${container.getMappedPort(5900)}`);\n\n  return container;\n}\n\nlet testContainer: StartedTestContainer;\n\n// eslint-disable-next-line import/no-mutable-exports\nlet aui: UiControlClient;\n\nbeforeAll(async () => {\n  testContainer = await startTestContainer();\n\n  aui = await UiControlClient.build({\n    uiControllerUrl: `http://127.0.0.1:${testContainer.getMappedPort(6769)}`,\n  });\n\n  await aui.connect();\n});\n\nafterAll(async () => {\n  aui.close();\n\n  await testContainer.stop();\n});\n\nexport { aui };\n\n"})}),"\n",(0,r.jsx)(n.h2,{id:"connect-via-vnc",children:"Connect via VNC"}),"\n",(0,r.jsxs)(n.p,{children:["To check what is happening inside a running test container, you can connect via VNC. For this, you need a VNC client like ",(0,r.jsx)(n.a,{href:"https://remmina.org/",children:"Remmina"}),". When starting the ",(0,r.jsx)(n.a,{href:"#starting-container-manually",children:"Docker Container manually"}),", you have to map the internal port ",(0,r.jsx)(n.code,{children:"5900"})," to a free port on your machine that you, then, can connect to. When ",(0,r.jsx)(n.a,{href:"#starting-container-from-within-beforeall-using-testcontainers",children:"using the testcontainers example code"}),", the VNC port to connect to is logged to the console."]}),"\n",(0,r.jsxs)(n.p,{children:["When connecting, enter the password ",(0,r.jsx)(n.code,{children:"askui"})," when asked."]}),"\n",(0,r.jsx)(n.p,{children:"Example of a VNC connection with a Chrome browser running inside a container:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"VNC Example",src:t(64682).Z+"",width:"2562",height:"1415"})})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},64682:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/vnc-example-9077144d46d3f03f74248609d25a18a5.png"},11151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>s});var r=t(67294);const i={},o=r.createContext(i);function s(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);